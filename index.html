<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Netlify Runner — Concept</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, sans-serif;
        background: radial-gradient(circle at 10% 0%, rgba(66, 184, 255, 0.07), transparent 36%),
          radial-gradient(circle at 82% 8%, rgba(28, 230, 182, 0.08), transparent 40%),
          #02060c;
      }

      #root {
        min-height: 100vh;
      }

      ::-webkit-scrollbar {
        width: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 999px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="module">
      import React, { useMemo, useState } from "https://esm.sh/react@18.2.0";
      import { createRoot } from "https://esm.sh/react-dom@18.2.0/client";
      import {
        AppBar,
        Avatar,
        Badge,
        Box,
        Button,
        Card,
        CardActions,
        CardContent,
        Chip,
        CssBaseline,
        Divider,
        Drawer,
        Grid,
        IconButton,
        LinearProgress,
        List,
        ListItemButton,
        ListItemIcon,
        ListItemText,
        Stack,
        ThemeProvider,
        Toolbar,
        Tooltip,
        Typography,
        createTheme,
        ToggleButtonGroup,
        ToggleButton,
        Tabs,
        Tab,
        Paper,
        alpha,
      } from "https://esm.sh/@mui/material@5.15.14";
      import { styled } from "https://esm.sh/@mui/material@5.15.14/styles";
      import RocketLaunchIcon from "https://esm.sh/@mui/icons-material@5.15.14/RocketLaunch";
      import DashboardIcon from "https://esm.sh/@mui/icons-material@5.15.14/Dashboard";
      import PeopleAltIcon from "https://esm.sh/@mui/icons-material@5.15.14/PeopleAlt";
      import CodeIcon from "https://esm.sh/@mui/icons-material@5.15.14/Code";
      import PlayArrowIcon from "https://esm.sh/@mui/icons-material@5.15.14/PlayArrow";
      import SecurityIcon from "https://esm.sh/@mui/icons-material@5.15.14/Security";
      import CheckCircleIcon from "https://esm.sh/@mui/icons-material@5.15.14/CheckCircle";
      import BlurOnIcon from "https://esm.sh/@mui/icons-material@5.15.14/BlurOn";
      import InsightsIcon from "https://esm.sh/@mui/icons-material@5.15.14/Insights";
      import LaunchIcon from "https://esm.sh/@mui/icons-material@5.15.14/Launch";
      import ChatIcon from "https://esm.sh/@mui/icons-material@5.15.14/Chat";
      import SwapHorizIcon from "https://esm.sh/@mui/icons-material@5.15.14/SwapHoriz";
      import PersonOutlineIcon from "https://esm.sh/@mui/icons-material@5.15.14/PersonOutline";
      import DoneAllIcon from "https://esm.sh/@mui/icons-material@5.15.14/DoneAll";

      const drawerWidth = 248;

      const glass = (theme) => ({
        background: alpha(theme.palette.background.paper, 0.7),
        border: `1px solid ${alpha(theme.palette.divider, 0.6)}`,
        boxShadow: "0 20px 80px rgba(0,0,0,0.35)",
        backdropFilter: "blur(16px)",
      });

      const Pulse = styled(Box)(({ theme }) => ({
        width: 10,
        height: 10,
        borderRadius: "50%",
        background: theme.palette.success.main,
        boxShadow: `0 0 0 10px ${alpha(theme.palette.success.main, 0.04)}`,
      }));

      const SparkleCard = styled(Card)(({ theme }) => ({
        ...glass(theme),
        borderRadius: 16,
        transition: "transform 0.2s ease, border 0.2s ease",
        '&:hover': {
          transform: "translateY(-2px)",
          borderColor: alpha(theme.palette.primary.main, 0.6),
        },
      }));

      const Pill = styled(Chip)(({ theme }) => ({
        background: alpha(theme.palette.common.white, 0.06),
        borderColor: alpha(theme.palette.common.white, 0.08),
      }));

      const stats = [
        {
          label: "Live sessions",
          value: "12",
          hint: "Stable",
          icon: <BlurOnIcon fontSize="small" />,
        },
        {
          label: "Deploys today",
          value: "6",
          hint: "+2 planned",
          icon: <LaunchIcon fontSize="small" />,
        },
        {
          label: "Guardrails",
          value: "18",
          hint: "all green",
          icon: <SecurityIcon fontSize="small" />,
        },
      ];

      const actionOptions = [
        { id: "preview", title: "Generate preview", meta: "site-wide", eta: "1m" },
        { id: "deploy", title: "Promote to production", meta: "main branch", eta: "2m" },
        { id: "roll-back", title: "Roll back", meta: "last stable", eta: "50s" },
      ];

      const queue = [
        { id: 1, title: "Rebuild marketing", owner: "Mina", mode: "dry" },
        { id: 2, title: "Rotate API keys", owner: "Alex", mode: "real" },
        { id: 3, title: "Sync env vars", owner: "Riley", mode: "dry" },
      ];

      const guardrails = [
        {
          id: "blast",
          label: "Blast radius",
          detail: "Auto-scope changes to safe projects",
          status: "active",
        },
        {
          id: "approvals",
          label: "Human approvals",
          detail: "Escalate risky actions to reviewers",
          status: "active",
        },
        {
          id: "records",
          label: "Ledger",
          detail: "Attach artifacts to compliance log",
          status: "active",
        },
      ];

      const theme = createTheme({
        palette: {
          mode: "dark",
          primary: {
            main: "#1ce6b6",
          },
          background: {
            default: "#02060c",
            paper: "#0c121a",
          },
          text: {
            primary: "#f8fbff",
            secondary: "#c5d0dd",
          },
        },
        shape: {
          borderRadius: 14,
        },
        typography: {
          fontFamily: "Inter, system-ui, -apple-system, sans-serif",
        },
      });

      const NavIcon = ({ icon }) => (
        <ListItemIcon sx={{ minWidth: 34, color: "text.secondary" }}>{icon}</ListItemIcon>
      );

      const PageHeader = ({ title, secondary }) => (
        <Stack direction="row" alignItems="center" spacing={1.5} mb={2.5}>
          <Pulse />
          <Typography variant="h5" fontWeight={700} letterSpacing={-0.4}>
            {title}
          </Typography>
          <Typography variant="body2" color="text.secondary">
            {secondary}
          </Typography>
        </Stack>
      );

      const MinimalCard = ({ title, caption, action, icon }) => (
        <SparkleCard variant="outlined">
          <CardContent>
            <Stack direction="row" spacing={1.2} alignItems="center" mb={1}>
              <Box
                sx={(theme) => ({
                  width: 36,
                  height: 36,
                  borderRadius: 2,
                  display: "grid",
                  placeItems: "center",
                  background: alpha(theme.palette.primary.main, 0.12),
                  color: theme.palette.primary.main,
                })}
              >
                {icon}
              </Box>
              <Typography fontWeight={700}>{title}</Typography>
            </Stack>
            <Typography variant="body2" color="text.secondary">
              {caption}
            </Typography>
          </CardContent>
          {action && <CardActions sx={{ pt: 0, pb: 2, px: 2 }}>{action}</CardActions>}
        </SparkleCard>
      );

      const Shell = ({ route, onRouteChange, children }) => (
        <Box sx={{ display: "flex" }}>
          <CssBaseline />
          <AppBar
            position="fixed"
            elevation={0}
            color="transparent"
            sx={(theme) => ({
              borderBottom: `1px solid ${alpha(theme.palette.divider, 0.5)}`,
              backdropFilter: "blur(12px)",
              background: alpha(theme.palette.background.paper, 0.7),
              ml: `${drawerWidth}px`,
              width: { sm: `calc(100% - ${drawerWidth}px)` },
            })}
          >
            <Toolbar sx={{ minHeight: 68, px: 3 }}>
              <Stack direction="row" spacing={2} alignItems="center" sx={{ flexGrow: 1 }}>
                <Box
                  sx={{
                    width: 42,
                    height: 42,
                    borderRadius: 2,
                    display: "grid",
                    placeItems: "center",
                    fontWeight: 800,
                    letterSpacing: 0.2,
                    background: "linear-gradient(135deg, #1ce6b6, #42b8ff)",
                    color: "#05121d",
                  }}
                >
                  NL
                </Box>
                <Divider orientation="vertical" flexItem sx={{ borderColor: "divider" }} />
                <Stack spacing={0.2}>
                  <Typography variant="subtitle2" fontWeight={700} letterSpacing={-0.2}>
                    Netlify Runner
                  </Typography>
                  <Typography variant="body2" color="text.secondary">
                    Calm, confident automation
                  </Typography>
                </Stack>
              </Stack>
              <Stack direction="row" spacing={1.2} alignItems="center">
                <Tooltip title="All clear">
                  <Badge color="success" variant="dot" overlap="circular">
                    <Avatar sx={{ width: 36, height: 36, bgcolor: "primary.main" }}>A</Avatar>
                  </Badge>
                </Tooltip>
              </Stack>
            </Toolbar>
          </AppBar>

          <Drawer
            variant="permanent"
            sx={{
              width: drawerWidth,
              flexShrink: 0,
              [`& .MuiDrawer-paper`]: {
                width: drawerWidth,
                boxSizing: "border-box",
                pt: 2.5,
                px: 2,
                gap: 1,
                borderRight: (theme) => `1px solid ${alpha(theme.palette.divider, 0.5)}`,
                background: (theme) => alpha(theme.palette.background.paper, 0.85),
                backdropFilter: "blur(16px)",
              },
            }}
          >
            <Toolbar />
            <List>
              {[
                { label: "Overview", value: "overview", icon: <DashboardIcon /> },
                { label: "Client Portal", value: "client", icon: <PeopleAltIcon /> },
                { label: "Developer Portal", value: "developer", icon: <CodeIcon /> },
              ].map((item) => (
                <ListItemButton
                  key={item.value}
                  selected={route === item.value}
                  onClick={() => onRouteChange(item.value)}
                  sx={{
                    my: 0.3,
                    borderRadius: 12,
                    '&.Mui-selected': {
                      background: (theme) => alpha(theme.palette.primary.main, 0.14),
                      color: "primary.main",
                    },
                  }}
                >
                  <NavIcon icon={item.icon} />
                  <ListItemText primary={item.label} />
                </ListItemButton>
              ))}
            </List>
            <Divider sx={{ my: 1.5 }} />
            <Box px={1.5} pb={3}>
              <MinimalCard
                title="Guardrail posture"
                caption="All controls engaged"
                icon={<SecurityIcon fontSize="small" />}
                action={<Button size="small" endIcon={<LaunchIcon />} sx={{ textTransform: "none" }}>View log</Button>}
              />
            </Box>
          </Drawer>

          <Box component="main" sx={{ flexGrow: 1, p: 3, ml: `${drawerWidth}px` }}>
            <Toolbar />
            {children}
          </Box>
        </Box>
      );

      const Overview = ({ onRouteChange }) => (
        <Stack spacing={3}>
          <PageHeader title="Home" secondary="Netlify runner status" />
          <Grid container spacing={2.2}>
            {stats.map((stat) => (
              <Grid item xs={12} md={4} key={stat.label}>
                <SparkleCard>
                  <CardContent>
                    <Stack direction="row" alignItems="center" spacing={1.2}>
                      <Box
                        sx={(theme) => ({
                          width: 40,
                          height: 40,
                          borderRadius: 2,
                          display: "grid",
                          placeItems: "center",
                          background: alpha(theme.palette.primary.main, 0.12),
                          color: theme.palette.primary.main,
                        })}
                      >
                        {stat.icon}
                      </Box>
                      <Stack>
                        <Typography variant="body2" color="text.secondary">
                          {stat.label}
                        </Typography>
                        <Typography variant="h5" fontWeight={800} letterSpacing={-0.5}>
                          {stat.value}
                        </Typography>
                      </Stack>
                      <Chip label={stat.hint} size="small" sx={{ ml: "auto" }} />
                    </Stack>
                  </CardContent>
                </SparkleCard>
              </Grid>
            ))}
          </Grid>
          <Grid container spacing={2.2}>
            <Grid item xs={12} md={6}>
              <MinimalCard
                title="Client portal"
                caption="Fast approvals, guided by the agent"
                icon={<PeopleAltIcon />}
                action={
                  <Button
                    variant="contained"
                    endIcon={<LaunchIcon />}
                    onClick={() => onRouteChange("client")}
                    sx={{ textTransform: "none", fontWeight: 700 }}
                  >
                    Open client
                  </Button>
                }
              />
            </Grid>
            <Grid item xs={12} md={6}>
              <MinimalCard
                title="Developer portal"
                caption="Policy tuning and live queue"
                icon={<CodeIcon />}
                action={
                  <Button
                    variant="outlined"
                    endIcon={<LaunchIcon />}
                    onClick={() => onRouteChange("developer")}
                    sx={{ textTransform: "none", fontWeight: 700 }}
                  >
                    Open developer
                  </Button>
                }
              />
            </Grid>
          </Grid>
        </Stack>
      );

      const ClientPortal = ({ onRun }) => (
        <Stack spacing={3}>
          <PageHeader title="Client" secondary="Ready to approve" />
          <Grid container spacing={2.2}>
            <Grid item xs={12} md={8}>
              <SparkleCard>
                <CardContent>
                  <Stack direction="row" spacing={1.5} alignItems="center" mb={1}>
                    <Typography variant="h6" fontWeight={800} letterSpacing={-0.5}>
                      Run an action
                    </Typography>
                    <Pill label="Agent guided" size="small" />
                  </Stack>
                  <Typography variant="body2" color="text.secondary" mb={2}>
                    Minimal prompt. The agent handles context and safety.
                  </Typography>
                  <Grid container spacing={1.4}>
                    {actionOptions.map((action) => (
                      <Grid item xs={12} sm={6} md={4} key={action.id}>
                        <Paper
                          variant="outlined"
                          sx={(theme) => ({
                            ...glass(theme),
                            borderRadius: 12,
                            p: 1.4,
                          })}
                        >
                          <Stack spacing={0.4}>
                            <Stack direction="row" spacing={1} alignItems="center">
                              <PlayArrowIcon fontSize="small" color="primary" />
                              <Typography fontWeight={700}>{action.title}</Typography>
                            </Stack>
                            <Typography variant="body2" color="text.secondary">
                              {action.meta}
                            </Typography>
                            <Chip label={`~${action.eta}`} size="small" sx={{ width: "fit-content" }} />
                            <Button
                              variant="contained"
                              fullWidth
                              endIcon={<RocketLaunchIcon />}
                              sx={{ textTransform: "none", mt: 0.6 }}
                              onClick={() => onRun(action)}
                            >
                              Stage
                            </Button>
                          </Stack>
                        </Paper>
                      </Grid>
                    ))}
                  </Grid>
                </CardContent>
              </SparkleCard>
            </Grid>
            <Grid item xs={12} md={4}>
              <SparkleCard>
                <CardContent>
                  <Stack direction="row" spacing={1.5} alignItems="center" mb={1}>
                    <ChatIcon color="primary" />
                    <Typography fontWeight={700}>Agent brief</Typography>
                  </Stack>
                  <Typography variant="body2" color="text.secondary">
                    The assistant keeps the experience quiet until you engage. Open a run to see the rationale and the safety checks it will apply.
                  </Typography>
                  <Divider sx={{ my: 2 }} />
                  <Stack spacing={1}>
                    <Stack direction="row" spacing={1} alignItems="center">
                      <SecurityIcon color="success" fontSize="small" />
                      <Typography variant="body2">Guardrails pre-flight</Typography>
                    </Stack>
                    <Stack direction="row" spacing={1} alignItems="center">
                      <InsightsIcon color="primary" fontSize="small" />
                      <Typography variant="body2">Dry runs narrate the plan</Typography>
                    </Stack>
                    <Stack direction="row" spacing={1} alignItems="center">
                      <CheckCircleIcon color="primary" fontSize="small" />
                      <Typography variant="body2">Artifacts pinned to the ledger</Typography>
                    </Stack>
                  </Stack>
                </CardContent>
              </SparkleCard>
            </Grid>
          </Grid>
        </Stack>
      );

      const DeveloperPortal = () => (
        <Stack spacing={3}>
          <PageHeader title="Developer" secondary="Tuning + oversight" />
          <Grid container spacing={2.2}>
            <Grid item xs={12} md={7}>
              <SparkleCard>
                <CardContent>
                  <Stack direction="row" justifyContent="space-between" alignItems="center" mb={1}>
                    <Typography variant="h6" fontWeight={800} letterSpacing={-0.5}>
                      Guardrails
                    </Typography>
                    <Pill label="Live" size="small" icon={<Pulse />} />
                  </Stack>
                  <Stack spacing={1.2}>
                    {guardrails.map((rule) => (
                      <Paper
                        key={rule.id}
                        variant="outlined"
                        sx={(theme) => ({
                          ...glass(theme),
                          p: 1.2,
                          borderRadius: 12,
                        })}
                      >
                        <Stack direction="row" alignItems="center" spacing={1.5}>
                          <SecurityIcon color="primary" />
                          <Stack>
                            <Typography fontWeight={700}>{rule.label}</Typography>
                            <Typography variant="body2" color="text.secondary">
                              {rule.detail}
                            </Typography>
                          </Stack>
                          <Chip
                            label={rule.status}
                            color="success"
                            size="small"
                            sx={{ ml: "auto", textTransform: "capitalize" }}
                          />
                        </Stack>
                      </Paper>
                    ))}
                  </Stack>
                </CardContent>
              </SparkleCard>
            </Grid>
            <Grid item xs={12} md={5}>
              <SparkleCard>
                <CardContent>
                  <Stack direction="row" spacing={1.2} alignItems="center" mb={1.5}>
                    <InsightsIcon color="primary" />
                    <Typography fontWeight={700}>Live queue</Typography>
                  </Stack>
                  <Stack spacing={1}>
                    {queue.map((item) => (
                      <Paper
                        key={item.id}
                        variant="outlined"
                        sx={(theme) => ({ ...glass(theme), p: 1.1, borderRadius: 11 })}
                      >
                        <Stack direction="row" spacing={1} alignItems="center">
                          <Avatar sx={{ width: 34, height: 34, bgcolor: "primary.main" }}>
                            {item.owner[0]}
                          </Avatar>
                          <Stack spacing={0}>
                            <Typography fontWeight={700}>{item.title}</Typography>
                            <Typography variant="body2" color="text.secondary">
                              {item.owner} · {item.mode === "dry" ? "Dry run" : "Real run"}
                            </Typography>
                          </Stack>
                          <SwapHorizIcon sx={{ ml: "auto", color: "text.secondary" }} />
                        </Stack>
                      </Paper>
                    ))}
                  </Stack>
                </CardContent>
              </SparkleCard>
            </Grid>
          </Grid>
        </Stack>
      );

      const RunDrawer = ({ open, onClose, action }) => {
        const [mode, setMode] = useState("dry");
        const [tab, setTab] = useState("context");

        const summaries = {
          context: "Agent assembles deploy context, branch status, and safety rails before touching infra.",
          plan: "Dry run narrates the deployment plan and asks for a final yes/no before applying.",
          human: "Escalate to a reviewer when scope changes, secrets rotate, or production blast radius grows.",
        };

        return (
          <Drawer
            anchor="right"
            open={open}
            onClose={onClose}
            PaperProps={{
              sx: (theme) => ({
                width: 420,
                borderLeft: `1px solid ${alpha(theme.palette.divider, 0.5)}`,
                background: alpha(theme.palette.background.paper, 0.9),
                backdropFilter: "blur(18px)",
              }),
            }}
          >
            <Box sx={{ p: 3, pt: 4 }}>
              <Stack direction="row" spacing={1.5} alignItems="center" mb={1}>
                <Avatar sx={{ bgcolor: "primary.main" }}>
                  <PlayArrowIcon />
                </Avatar>
                <Stack>
                  <Typography fontWeight={800}>{action?.title || "Pick an action"}</Typography>
                  <Typography variant="body2" color="text.secondary">
                    {action?.meta || "Select a card to see the plan"}
                  </Typography>
                </Stack>
              </Stack>
              <ToggleButtonGroup
                value={mode}
                exclusive
                onChange={(_, val) => val && setMode(val)}
                fullWidth
                size="small"
                sx={{ my: 2 }}
              >
                <ToggleButton value="dry">Dry run</ToggleButton>
                <ToggleButton value="real">Real run</ToggleButton>
              </ToggleButtonGroup>
              <Stack spacing={1} mb={2}>
                <Stack direction="row" spacing={1} alignItems="center">
                  <SecurityIcon color="success" fontSize="small" />
                  <Typography variant="body2">Agent explanation</Typography>
                </Stack>
                <Typography variant="body2" color="text.secondary">
                  {mode === "dry"
                    ? "The agent narrates the steps, checks guardrails, and holds for your go-ahead."
                    : "Applying with existing guardrails. Artifacts will be attached to the ledger."}
                </Typography>
              </Stack>
              <Tabs value={tab} onChange={(_, value) => setTab(value)} sx={{ mb: 2 }}>
                <Tab value="context" label="Context" />
                <Tab value="plan" label="Plan" />
                <Tab value="human" label="Human" />
              </Tabs>
              <Typography variant="body2" color="text.secondary" mb={2}>
                {summaries[tab]}
              </Typography>
              <Paper
                variant="outlined"
                sx={(theme) => ({ ...glass(theme), p: 1.5, borderRadius: 12, mb: 2 })}
              >
                <Stack spacing={0.8}>
                  <Stack direction="row" spacing={1} alignItems="center">
                    <CheckCircleIcon color="primary" fontSize="small" />
                    <Typography variant="body2">Ready for {mode === "dry" ? "simulation" : "apply"}</Typography>
                  </Stack>
                  <LinearProgress variant="determinate" value={mode === "dry" ? 60 : 40} />
                  <Typography variant="caption" color="text.secondary">
                    Guardrails are locked in before the agent proceeds.
                  </Typography>
                </Stack>
              </Paper>
              <Stack direction="row" spacing={1}>
                <Button
                  fullWidth
                  variant="contained"
                  sx={{ textTransform: "none", fontWeight: 700 }}
                  endIcon={<DoneAllIcon />}
                >
                  {mode === "dry" ? "Confirm dry run" : "Authorize run"}
                </Button>
                <Button
                  fullWidth
                  variant="outlined"
                  sx={{ textTransform: "none" }}
                  endIcon={<PersonOutlineIcon />}
                >
                  Route to human
                </Button>
              </Stack>
            </Box>
          </Drawer>
        );
      };

      const App = () => {
        const [route, setRoute] = useState("overview");
        const [drawer, setDrawer] = useState({ open: false, action: null });

        const handleRun = (action) => setDrawer({ open: true, action });

        return (
          <ThemeProvider theme={theme}>
            <Shell route={route} onRouteChange={setRoute}>
              {route === "overview" && <Overview onRouteChange={setRoute} />}
              {route === "client" && <ClientPortal onRun={handleRun} />}
              {route === "developer" && <DeveloperPortal />}
            </Shell>
            <RunDrawer
              open={drawer.open}
              action={drawer.action}
              onClose={() => setDrawer((d) => ({ ...d, open: false }))}
            />
          </ThemeProvider>
        );
      };

      const root = createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
